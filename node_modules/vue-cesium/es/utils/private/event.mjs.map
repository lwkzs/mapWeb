{"version":3,"file":"event.mjs","sources":["../../../../../packages/utils/private/event.ts"],"sourcesContent":["export const listenOpts = {\n  hasPassive: false,\n  passiveCapture: true,\n  notPassiveCapture: true,\n  passive: undefined\n}\n\ntry {\n  const opts = Object.defineProperty({}, 'passive', {\n    get() {\n      Object.assign(listenOpts, {\n        hasPassive: true,\n        passive: { passive: true },\n        notPassive: { passive: false },\n        passiveCapture: { passive: true, capture: true },\n        notPassiveCapture: { passive: false, capture: true }\n      })\n    }\n  })\n  window.addEventListener('qtest', null as any, opts)\n  window.removeEventListener('qtest', null as any, opts)\n} catch (e) {\n  //\n}\n\n// eslint-disable-next-line @typescript-eslint/no-empty-function\nexport function noop() {}\n\nexport function leftClick(e) {\n  return e.button === 0\n}\n\nexport function middleClick(e) {\n  return e.button === 1\n}\n\nexport function rightClick(e) {\n  return e.button === 2\n}\n\nexport function position(e) {\n  if (e.touches && e.touches[0]) {\n    e = e.touches[0]\n  } else if (e.changedTouches && e.changedTouches[0]) {\n    e = e.changedTouches[0]\n  } else if (e.targetTouches && e.targetTouches[0]) {\n    e = e.targetTouches[0]\n  }\n\n  return {\n    top: e.clientY,\n    left: e.clientX\n  }\n}\n\nexport function getEventPath(e) {\n  if (e.path) {\n    return e.path\n  }\n  if (e.composedPath) {\n    return e.composedPath()\n  }\n\n  const path: Array<Document | Window> = []\n  let el = e.target\n\n  while (el) {\n    path.push(el)\n\n    if (el.tagName === 'HTML') {\n      path.push(document)\n      path.push(window)\n      return path\n    }\n\n    el = el.parentElement\n  }\n}\n\n// Reasonable defaults\nconst LINE_HEIGHT = 40,\n  PAGE_HEIGHT = 800\n\nexport function getMouseWheelDistance(e) {\n  let x = e.deltaX,\n    y = e.deltaY\n\n  if ((x || y) && e.deltaMode) {\n    const multiplier = e.deltaMode === 1 ? LINE_HEIGHT : PAGE_HEIGHT\n    x *= multiplier\n    y *= multiplier\n  }\n\n  if (e.shiftKey && !x) {\n    ;[y, x] = [x, y]\n  }\n\n  return { x, y }\n}\n\nexport function stop(e) {\n  e.stopPropagation()\n}\n\nexport function prevent(e) {\n  e.cancelable !== false && e.preventDefault()\n}\n\nexport function stopAndPrevent(e) {\n  e.cancelable !== false && e.preventDefault()\n  e.stopPropagation()\n}\n\nexport function preventDraggable(el, status) {\n  if (el === void 0 || (status === true && el.__dragPrevented === true)) {\n    return\n  }\n\n  const fn =\n    status === true\n      ? el => {\n          el.__dragPrevented = true\n          el.addEventListener('dragstart', prevent, listenOpts.notPassiveCapture)\n        }\n      : el => {\n          delete el.__dragPrevented\n          el.removeEventListener('dragstart', prevent, listenOpts.notPassiveCapture)\n        }\n\n  el.querySelectorAll('a, img').forEach(fn)\n}\n\nexport function addEvt(ctx, targetName, events) {\n  const name = `__vc_${targetName}_evt`\n\n  ctx[name] = ctx[name] !== void 0 ? ctx[name].concat(events) : events\n\n  events.forEach(evt => {\n    evt[0].addEventListener(evt[1], ctx[evt[2]], listenOpts[evt[3]])\n  })\n}\n\nexport function cleanEvt(ctx, targetName) {\n  const name = `__vc_${targetName}_evt`\n\n  if (ctx[name] !== void 0) {\n    ctx[name].forEach(evt => {\n      evt[0].removeEventListener(evt[1], ctx[evt[2]], listenOpts[evt[3]])\n    })\n    ctx[name] = void 0\n  }\n}\n\n/*\n * also update /types/utils/event.d.ts\n */\n\nexport default {\n  listenOpts,\n  leftClick,\n  middleClick,\n  rightClick,\n  position,\n  getEventPath,\n  getMouseWheelDistance,\n  stop,\n  prevent,\n  stopAndPrevent,\n  preventDraggable\n}\n"],"names":["el"],"mappings":"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"}