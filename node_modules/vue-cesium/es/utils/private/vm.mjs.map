{"version":3,"file":"vm.mjs","sources":["../../../../../packages/utils/private/vm.ts"],"sourcesContent":["/*\n * @Author: zouyaoji@https://github.com/zouyaoji\n * @Date: 2021-09-16 09:28:13\n * @LastEditTime: 2021-12-31 09:28:32\n * @LastEditors: zouyaoji\n * @Description:\n * @FilePath: \\vue-cesium@next\\packages\\utils\\private\\vm.ts\n */\nimport { Ref } from 'vue'\nimport { AnyFunction, VcComponentInternalInstance } from '../types'\nimport { camelCase, capitalize } from '../util'\nimport { findIndex } from 'lodash-unified'\n\n// used directly by docs too\nexport function getParentVm(vm) {\n  if (vm.$parent !== void 0 && vm.$parent !== null) {\n    return vm.$parent\n  }\n\n  vm = vm.$.parent\n\n  while (vm !== void 0 && vm !== null) {\n    if (vm.proxy !== void 0 && vm.proxy !== null) {\n      return vm.proxy\n    }\n\n    vm = vm.parent\n  }\n}\n\n// vnodes from rendered in advanced slots\nexport function getNormalizedVNodes(vnodes) {\n  const children = new Set()\n\n  vnodes.forEach(vnode => {\n    if (typeof vnode.type === 'symbol' && Array.isArray(vnode.children) === true) {\n      vnode.children.forEach(child => {\n        children.add(child)\n      })\n    } else {\n      children.add(vnode)\n    }\n  })\n\n  return Array.from(children)\n}\n\nexport function vmHasRouter(vm) {\n  return vm.appContext.config.globalProperties.$router !== void 0\n}\n\nexport function vmHasListener(vm, listenerName) {\n  return vm.vnode.props !== null && vm.vnode.props[listenerName] !== void 0\n}\n\nexport function getInstanceListener(vcInstance: VcComponentInternalInstance, listenerName: string) {\n  const props = vcInstance.vnode.props\n  if (props === null) {\n    return undefined\n  }\n  const propKeys = Object.keys(props)\n  const index = findIndex(propKeys, o => {\n    return o.includes(`on${capitalize(listenerName)}`) || o.includes(`on${capitalize(camelCase(listenerName))}`)\n  })\n  const listener = props[propKeys[index]]\n  return listener as AnyFunction<any>\n}\n\n/**\n * Unwraps refed value\n * @param ref Refed value\n */\nexport function $<T>(ref: Ref<T>) {\n  return ref.value\n}\n\nexport function getVcParentInstance(instance: VcComponentInternalInstance): VcComponentInternalInstance {\n  const parentInstance = instance.parent as VcComponentInternalInstance\n  return !parentInstance.cesiumClass && parentInstance.proxy?.$options.name !== 'VcViewer' ? getVcParentInstance(parentInstance) : parentInstance\n}\n"],"names":[],"mappings":"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"}