{"version":3,"file":"index.js","sources":["../../../../../packages/composables/use-primitive-collections/index.ts"],"sourcesContent":["/*\n * @Author: zouyaoji@https://github.com/zouyaoji\n * @Date: 2021-06-04 13:55:35\n * @LastEditTime: 2022-08-12 11:47:16\n * @LastEditors: zouyaoji\n * @Description:\n * @FilePath: \\10_vue-cesium\\packages\\composables\\use-primitive-collections\\index.ts\n */\n/**\n * for\n * PrimitiveCollection\n * BillboardCollection\n * LabelCollection\n * PointPrimitiveCollection\n * PolylineCollection\n */\n\nimport { VcComponentInternalInstance, VcViewerProvider } from '@vue-cesium/utils/types'\nimport useCommon from '../use-common'\nimport { mergeDescriptors } from '@vue-cesium/utils/merge-descriptors'\nimport { provide } from 'vue'\nimport { vcKey } from '@vue-cesium/utils/config'\n\nexport type Collection =\n  | Cesium.PrimitiveCollection\n  | Cesium.BillboardCollection\n  | Cesium.LabelCollection\n  | Cesium.PointPrimitiveCollection\n  | Cesium.PolylineCollection\n\nexport default function (props, ctx, vcInstance: VcComponentInternalInstance) {\n  // state\n\n  vcInstance.cesiumEvents = ['primitiveAdded', 'primitiveRemoved']\n\n  const commonState = useCommon(props, ctx, vcInstance)\n  if (commonState === void 0) {\n    return\n  }\n  // methods\n  vcInstance.mount = async () => {\n    const primitives = commonState.$services.primitives\n    const collection = vcInstance.cesiumObject as Collection\n    const object = primitives && primitives.add(collection)\n    return Cesium.defined(object)\n  }\n  vcInstance.unmount = async () => {\n    const primitives = commonState.$services.primitives\n    const collection = vcInstance.cesiumObject as Collection\n    return primitives && primitives.remove(collection)\n  }\n\n  const getServices = (): VcViewerProvider => {\n    return mergeDescriptors(commonState.getServices(), {\n      get primitives() {\n        return vcInstance.cesiumObject as Collection\n      }\n    })\n  }\n\n  // provide\n  provide(vcKey, getServices())\n\n  return {\n    transformProps: commonState.transformProps,\n    transformProp: commonState.transformProp,\n    unwatchFns: commonState.unwatchFns,\n    setPropsWatcher: commonState.setPropsWatcher\n  }\n}\n"],"names":["useCommon","mergeDescriptors","provide","vcKey"],"mappings":";;;;;;;;;;AA8ByB,gCAAA,CAAA,KAAA,EAAO,KAAK,UAAyC,EAAA;AAG5E,EAAW,UAAA,CAAA,YAAA,GAAe,CAAC,gBAAA,EAAkB,kBAAkB,CAAA,CAAA;AAE/D,EAAA,MAAM,WAAc,GAAAA,gBAAA,CAAU,KAAO,EAAA,GAAA,EAAK,UAAU,CAAA,CAAA;AACpD,EAAA,IAAI,gBAAgB,KAAQ,CAAA,EAAA;AAC1B,IAAA,OAAA;AAAA,GACF;AAEA,EAAA,UAAA,CAAW,QAAQ,YAAY;AAC7B,IAAM,MAAA,UAAA,GAAa,YAAY,SAAU,CAAA,UAAA,CAAA;AACzC,IAAA,MAAM,aAAa,UAAW,CAAA,YAAA,CAAA;AAC9B,IAAA,MAAM,MAAS,GAAA,UAAA,IAAc,UAAW,CAAA,GAAA,CAAI,UAAU,CAAA,CAAA;AACtD,IAAO,OAAA,MAAA,CAAO,QAAQ,MAAM,CAAA,CAAA;AAAA,GAC9B,CAAA;AACA,EAAA,UAAA,CAAW,UAAU,YAAY;AAC/B,IAAM,MAAA,UAAA,GAAa,YAAY,SAAU,CAAA,UAAA,CAAA;AACzC,IAAA,MAAM,aAAa,UAAW,CAAA,YAAA,CAAA;AAC9B,IAAO,OAAA,UAAA,IAAc,UAAW,CAAA,MAAA,CAAO,UAAU,CAAA,CAAA;AAAA,GACnD,CAAA;AAEA,EAAA,MAAM,cAAc,MAAwB;AAC1C,IAAO,OAAAC,iCAAA,CAAiB,WAAY,CAAA,WAAA,EAAe,EAAA;AAAA,MACjD,IAAI,UAAa,GAAA;AACf,QAAA,OAAO,UAAW,CAAA,YAAA,CAAA;AAAA,OACpB;AAAA,KACD,CAAA,CAAA;AAAA,GACH,CAAA;AAGA,EAAQC,WAAA,CAAAC,YAAA,EAAO,aAAa,CAAA,CAAA;AAE5B,EAAO,OAAA;AAAA,IACL,gBAAgB,WAAY,CAAA,cAAA;AAAA,IAC5B,eAAe,WAAY,CAAA,aAAA;AAAA,IAC3B,YAAY,WAAY,CAAA,UAAA;AAAA,IACxB,iBAAiB,WAAY,CAAA,eAAA;AAAA,GAC/B,CAAA;AACF;;;;"}